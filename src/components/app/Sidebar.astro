---
// Sidebar component for the app view
---

<aside class="sidebar">
    <div class="section">
        <div class="sidebar-title" data-i18n="app.sidebar_idea">
            1. Votre Idée (Prompt)
        </div>
        <textarea
            id="promptInput"
            class="input-field"
            rows="4"
            placeholder="Décrivez votre miniature (ex: Visage choqué, fond explosion, texte 'INCROYABLE'...)"
            data-i18n="app.prompt_placeholder"></textarea>
        <input
            type="text"
            id="titleInput"
            class="input-field"
            style="margin-top: 0.5rem;"
            placeholder="Texte à afficher sur la miniature (optionnel)"
            data-i18n="app.title_placeholder"
        />
    </div>

    <div class="section">
        <details class="remix-details">
            <summary class="sidebar-title remix-summary">
                <span data-i18n="remix.title">Remix</span>
                <i class="fa-solid fa-chevron-right remix-chevron"></i>
            </summary>

            <div class="remix-content">
                <div class="remix-input-row">
                    <input
                        type="text"
                        id="remixUrlInput"
                        class="input-field"
                        placeholder="Collez une URL YouTube..."
                        data-i18n="remix.url_placeholder"
                    />
                    <button id="remixLoadBtn" class="btn btn-primary remix-load-btn">
                        <i class="fa-solid fa-download"></i>
                        <span data-i18n="remix.btn_load">Charger</span>
                    </button>
                </div>

                <div id="remixStatus" class="remix-status hidden"></div>

                <div id="remixPreview" class="remix-preview hidden">
                    <img id="remixThumbnail" class="remix-thumbnail" alt="YouTube Thumbnail" />
                    <p id="remixTitle" class="remix-video-title"></p>
                    <button id="remixClearBtn" class="btn btn-secondary remix-clear-btn">
                        <i class="fa-solid fa-times"></i>
                        <span data-i18n="remix.clear">Effacer</span>
                    </button>
                </div>
            </div>
        </details>
    </div>

    <div class="section">
        <div
            class="sidebar-title"
            style="display: flex; justify-content: space-between; align-items: center;"
        >
            <span data-i18n="app.sidebar_ref"
                >2. Images de Référence (Optionnel)</span
            >
            <span
                id="imageCount"
                style="font-size: 0.75rem; color: var(--text-muted);">0/14</span
            >
        </div>
        <div id="previewContainer" class="preview-img-grid">
            <!-- Images will be rendered here by JS -->
        </div>
        <div class="drop-zone" id="dropZone">
            <i
                class="fa-solid fa-cloud-arrow-up"
                style="font-size: 1.5rem; margin-bottom: 0.5rem; color: var(--text-muted);"
            ></i>
            <p
                style="font-size: 0.8rem; color: var(--text-muted);"
                data-i18n="app.drop_text"
            >
                Cliquez ou glissez des images ici
            </p>
            <p
                class="drop-zone-max-text"
                style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.3rem;"
            >
                Max 14 images
            </p>
            <input
                type="file"
                id="fileInput"
                accept="image/*"
                multiple
                hidden
            />
        </div>
        <button id="clearAllBtn" class="btn btn-secondary clear-all-btn">
            <i class="fa-solid fa-trash"></i>
            <span data-i18n="app.btn_clear_all">Tout effacer</span>
        </button>
    </div>

    <div class="section">
        <details class="settings-details">
            <summary class="sidebar-title settings-summary">
                <span data-i18n="app.sidebar_settings">3. Paramètres</span>
                <i class="fa-solid fa-chevron-right settings-chevron"></i>
            </summary>

            <div class="settings-content">
                <div class="select-row">
                    <div class="input-group">
                        <label data-i18n="app.label_resolution">Résolution</label>
                        <select id="resolutionSelect" class="input-field">
                            <option value="1K" data-i18n="app.opt_1k"
                                >1K (Rapide)</option
                            >
                            <option value="2K" selected data-i18n="app.opt_2k"
                                >2K (Standard)</option
                            >
                            <option value="4K" data-i18n="app.opt_4k"
                                >4K (Haut de gamme)</option
                            >
                        </select>
                    </div>
                    <div class="input-group">
                        <label data-i18n="app.label_ratio">Format (Ratio)</label>
                        <select id="aspectRatioSelect" class="input-field">
                            <option value="16:9" selected data-i18n="app.opt_16_9"
                                >16:9 (Youtube)</option
                            >
                            <option value="9:16" data-i18n="app.opt_9_16"
                                >9:16 (Shorts)</option
                            >
                            <option value="4:3" data-i18n="app.opt_4_3">4:3</option>
                            <option value="1:1" data-i18n="app.opt_1_1"
                                >1:1 (Carré)</option
                            >
                            <option value="match_input_image" data-i18n="app.opt_match"
                                >Match Input</option
                            >
                        </select>
                    </div>
                </div>

                <div class="select-row">
                    <div class="input-group">
                        <label data-i18n="app.label_format">Format Fichier</label>
                        <select id="formatSelect" class="input-field">
                            <option value="png">PNG</option>
                            <option value="jpg">JPG</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label data-i18n="app.label_safety">Sécurité</label>
                        <select id="safetySelect" class="input-field">
                            <option
                                value="block_medium_and_above"
                                data-i18n="app.opt_medium">Moyen</option
                            >
                            <option
                                value="block_only_high"
                                selected
                                data-i18n="app.opt_permissive">Permissif</option
                            >
                            <option
                                value="block_low_and_above"
                                data-i18n="app.opt_strict">Strict</option
                            >
                        </select>
                    </div>
                </div>
            </div>
        </details>
    </div>

    <button class="btn btn-primary" id="generateBtn">
        <i class="fa-solid fa-wand-magic-sparkles"></i>
        <span data-i18n="app.btn_generate">Générer Miniature</span>
    </button>

    <a
        id="githubStarBtn"
        href="https://github.com/yoanbernabeu/NanoThumbnail"
        target="_blank"
        class="btn btn-secondary github-star-btn"
    >
        <i class="fa-brands fa-github" style="color: gold;"></i>
        <span data-i18n="header.github_star">Star sur GitHub</span>
    </a>
</aside>

<style>
    .sidebar {
        width: 380px;
        border-right: 1px solid var(--border);
        padding: 1.5rem;
        overflow-y: auto;
        background: rgba(19, 19, 31, 0.5);
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .sidebar-title {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--text-muted);
        margin-bottom: 1rem;
        font-weight: 700;
    }

    .section {
        display: flex;
        flex-direction: column;
    }

    .select-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
    }

    .input-group {
        margin-bottom: 0.5rem;
        text-align: left;
    }

    .input-group label {
        display: block;
        margin-bottom: 0.3rem;
        font-size: 0.8rem;
        color: var(--text-muted);
    }

    /* Settings details/summary */
    .settings-details {
        width: 100%;
    }

    .settings-details summary {
        list-style: none;
    }

    .settings-details summary::-webkit-details-marker {
        display: none;
    }

    .settings-summary {
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        user-select: none;
    }

    .settings-chevron {
        font-size: 0.7rem;
        transition: transform 0.2s ease;
        color: var(--text-muted);
    }

    .settings-details[open] .settings-chevron {
        transform: rotate(90deg);
    }

    .settings-content {
        margin-top: 0.75rem;
    }

    .clear-all-btn {
        display: none;
        margin-top: 0.5rem;
        width: 100%;
    }

    .github-star-btn {
        margin-top: auto;
        padding: 12px;
        font-size: 0.9rem;
        color: var(--text-main);
        text-decoration: none;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    /* Image Upload */
    .drop-zone {
        border: 2px dashed var(--border);
        border-radius: var(--radius);
        padding: 2rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.02);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .drop-zone:hover {
        border-color: var(--primary);
        background: rgba(109, 40, 217, 0.05);
    }

    .drop-zone.compact {
        padding: 1rem;
        margin-top: 0;
    }

    .drop-zone.compact p {
        font-size: 0.75rem;
        margin: 0;
    }

    .drop-zone.compact i {
        font-size: 1.2rem !important;
        margin-bottom: 0.3rem !important;
    }

    .drop-zone.compact .drop-zone-max-text {
        display: none;
    }

    .drop-zone.disabled {
        cursor: not-allowed;
        border-color: rgba(255, 255, 255, 0.05);
    }

    .drop-zone.disabled:hover {
        border-color: rgba(255, 255, 255, 0.05);
        background: rgba(255, 255, 255, 0.02);
    }

    /* Preview Grid */
    .preview-img-grid {
        display: none;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 0.5rem;
        margin-bottom: 0.5rem;
    }

    /* Remix section */
    .remix-details {
        width: 100%;
    }

    .remix-details summary {
        list-style: none;
    }

    .remix-details summary::-webkit-details-marker {
        display: none;
    }

    .remix-summary {
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        user-select: none;
    }

    .remix-chevron {
        font-size: 0.7rem;
        transition: transform 0.2s ease;
        color: var(--text-muted);
    }

    .remix-details[open] .remix-chevron {
        transform: rotate(90deg);
    }

    .remix-content {
        margin-top: 0.75rem;
    }

    .remix-input-row {
        display: flex;
        gap: 0.5rem;
        align-items: stretch;
    }

    .remix-input-row .input-field {
        flex: 1;
        min-width: 0;
    }

    .remix-load-btn {
        padding: 0.5rem 0.75rem;
        font-size: 0.8rem;
        white-space: nowrap;
        flex-shrink: 0;
    }

    .remix-status {
        margin-top: 0.5rem;
        font-size: 0.8rem;
        padding: 0.4rem 0.6rem;
        border-radius: var(--radius);
    }

    .remix-status.error {
        color: #ff6b6b;
        background: rgba(255, 107, 107, 0.1);
    }

    .remix-status.success {
        color: #51cf66;
        background: rgba(81, 207, 102, 0.1);
    }

    .remix-status.loading {
        color: var(--text-muted);
        background: rgba(255, 255, 255, 0.05);
    }

    .remix-preview {
        margin-top: 0.75rem;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 0.75rem;
        background: rgba(255, 255, 255, 0.02);
    }

    .remix-thumbnail {
        width: 100%;
        border-radius: calc(var(--radius) - 2px);
        object-fit: cover;
        aspect-ratio: 16 / 9;
    }

    .remix-video-title {
        font-size: 0.8rem;
        color: var(--text-main);
        margin: 0.5rem 0;
        line-height: 1.3;
        word-break: break-word;
    }

    .remix-clear-btn {
        width: 100%;
        margin-top: 0.25rem;
        font-size: 0.8rem;
        padding: 0.4rem;
    }

    @media (max-width: 900px) {
        .sidebar {
            width: 100%;
            height: auto;
            border-right: none;
            border-bottom: 1px solid var(--border);
        }
    }
</style>
